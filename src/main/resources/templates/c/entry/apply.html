<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<title>纳品申请</title>

	<link th:href="@{/css/bootstrap.min.css}" rel="stylesheet" />
	<link th:href="@{/css/plugins/sweetalert/sweetalert.css}" rel="stylesheet" />

	<!-- Data Tables -->
	<link th:href="@{/css/plugins/dataTables/datatables.min.css}" rel="stylesheet">
	<link th:href="@{/css/plugins/jasny/jasny-bootstrap.min.css}" rel="stylesheet">
	<link th:href="@{/font-awesome/css/font-awesome.css}" rel="stylesheet" />
	<link th:href="@{/css/style.css}" rel="stylesheet" />
	<link th:href="@{/css/plugins/datapicker/datepicker3.css}"
		  rel="stylesheet">
	<link th:href="@{/css/plugins/iCheck/custom.css}" rel="stylesheet" />
	<link th:href="@{/css/plugins/footable/footable.core.css}"
		  rel="stylesheet" />
	<link th:href="@{/css/bootstrap-select.css}" rel="stylesheet">

</head>

<body>

	<div id="wrapper">
		<nav class="navbar-default navbar-static-side" role="navigation"
			th:include="/c/nav :: navigation"></nav>
		<div id="page-wrapper" class="gray-bg">
			<div class="border-bottom" th:include="/c/header :: headerTop"></div>
			<div class="row wrapper border-bottom white-bg page-heading"
				th:fragment="headerNav">
				<div class="col-lg-10">
					<h2>纳品申请</h2>
					<ol class="breadcrumb">
						<li><a href="#">首页</a></li>
						<li><a>库存管理</a></li>
						<li class="active"><strong>纳品申请</strong></li>
					</ol>
				</div>
				<div class="col-lg-2"></div>
			</div>

			<div class="wrapper wrapper-content animated fadeInRight">
				<div class="row">
				<form id="form" th:action="@{/b/entry/apply/upload}" method="post" enctype="multipart/form-data">
					<div class="col-lg-12">
						<div class="ibox float-e-margins">
							<div class="ibox-title">
								<h5>批量申请</h5>
								<div class="ibox-tools">
									<a class="collapse-link"> <i class="fa fa-chevron-up"></i>
									</a>
								</div>
							</div>
							<div class="ibox-content" style="display: block;">
								<div class="fileinput fileinput-new input-group"
									data-provides="fileinput">
									<div class="form-control" data-trigger="fileinput">
										<i class="glyphicon glyphicon-file fileinput-exists"></i> <span
											class="fileinput-filename"></span>
									</div>
									<span class="input-group-addon btn btn-default btn-file">
										<span class="fileinput-new">Select file</span> <span
										class="fileinput-exists">Change</span> <input type="file"
										name="applyFile" />
									</span> <a href="#"
										class="input-group-addon btn btn-warning fileinput-exists"
										data-dismiss="fileinput">Remove</a> <a href="#" id="doUpload"
										class="input-group-addon btn btn-primary fileinput-exists"
										data-dismiss="fileinput">提交纳品</a>
								</div>
								<button type="button" class="btn btn-primary" onclick="downloadEntryFile()">模板下载</button>
							</div>
						</div>
					</div>
				</form>
				<div class="col-lg-12">
						<div class="ibox float-e-margins">
							<div class="ibox-title">
								<h5>纳品文件数据错误说明</h5>
								<div class="ibox-tools">
									<a class="collapse-link"> <i class="fa fa-chevron-up"></i>
									</a>
								</div>
							</div>
							<div class="ibox-content" style="display: block;">
								<div class="row">
									<div class="col-sm-9">
										<div class="form-group" style="color:green">【正确数据：<span th:text="${successCount}"></span>条】</div>
										<div class="form-group" style="color:red">
											<div>【错误数据：<span th:text="${failCount}"></span>条】
												<span th:if="${failCount > 0}">
													<span th:each="p,pIndex:${errorList}"><!--取出每一个错误的行-->
														<div>
															【错误行号：<span th:text="${p[0]}"></span>---->
																错误列：<span th:if="${p[1] != 0}" th:text="${p[1]}"></span>
																		<span th:if="${p[2] != 0}" th:text="${p[2]}"></span>
																		<span th:if="${p[3] != 0}" th:text="${p[3]}"></span>
																		<span th:if="${p[4] != 0}" th:text="${p[4]}"></span>
																		<span th:if="${p[5] != 0}" th:text="${p[5]}"></span>
																		<span th:if="${p[6] != 0}" th:text="${p[6]}"></span>
															】
														</div>
													</span>


												</span>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				<div class="col-lg-12">
					<div class="ibox float-e-margins">
						<div class="ibox-title">
							<h5>搜索&amp;操作</h5>
							<div class="ibox-tools">
								<a class="collapse-link"> <i class="fa fa-chevron-up"></i>
								</a>
							</div>
						</div>
						<div class="ibox-content" style="display: block;">
							<div class="row">
								<div class="col-sm-2">
									<div class="form-group">
										<label class="control-label" for="product_name">商品SKU</label>
										<select id="goods_sku"  class="selectpicker bs-select show-tick form-control"
												title='请选择sku'  data-live-search="true"    multiple></select>
									</div>
								</div>
								<div class="col-sm-2">
									<div class="form-group">
										<label class="control-label" for="price">商品条码</label> <input
											type="text" id="goods_barCode" name="price" value=""
											class="form-control">
									</div>
								</div>
								<div class="col-sm-2">
									<div class="form-group">
										<label class="control-label" for="quantity">商品名称</label> <input
											type="text" id="goods_name" name="quantity" value=""
											class="form-control">
									</div>
								</div>
								<div class="col-sm-2">
									<div class="form-group">
										<label class="control-label" for="status">商品分类</label> <select
											name="status" id="type" class="form-control">
										<option value="1" selected="">全部分类</option>
										<option value="0">フラッシュメモリ</option>
									</select>
									</div>
								</div>
								<div class="col-sm-1">
									<div class="form-group">
										<label class="control-label" for="quantity1">库存数量</label> <input
											type="text" id="goods_nums" name="quantity1" value=""
											class="form-control" onkeyup="value=value.replace(/[^\d]/g,'')">
									</div>
								</div>
								<div class="col-sm-1">
									<div class="form-group z-t">
										<button type="button" class="btn btn-primary" onclick="searchStock()">检索</button>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-lg-12">
					<div class="ibox float-e-margins">
						<div class="ibox-title">
							<h5>库存列表</h5>
							<div class="ibox-tools">
								<a class="collapse-link"> <i class="fa fa-chevron-up"></i>
								</a>
							</div>
						</div>
						<div class="ibox-content">
							<div class="form-group">
								<div class="table-responsive">
									<table class="table table-striped table-bordered table-hover dataTables-example" id="table_refresh"  th:fragment="table_refresh">
										<thead>
											<tr>
												<th></th>
												<th>#</th>
												<th>SKU</th>
												<th>分类</th>
												<th>名称</th>
												<th>在库数量</th>
												<th>纳品数量</th>
												<th>包裹尺寸(cm³)</th>
												<th>内盒数量</th>
												<th>盒内商品数量</th>
												<th>有效期</th>
												<th>操作</th>
											</tr>
										</thead>
										<tbody>
											<tr th:each="p,pIndex:${item}">
												<td><input type="checkbox" class="i-checks"
														   name="entryCheckBox" th:id="${p.goodsId}" /></td>
												<td th:text="${pIndex.count}"></td>
												<td th:text="${p.sku}"></td>
												<td th:text="${p.categoryName}"></td>
												<td th:text="${p.goodsName}"></td>
												<td th:text="${p.nums}"></td>
												<td th:id = "entryNums+(${p.goodsId})"><input type="text"  onkeyup="value=value.replace(/[^\d]/g,'')"/></td>
												<td th:id = "packageSize+(${p.goodsId})"><input type="text" onkeyup="value=value.replace(/[^\d{1,}\.\d{1,}|\d{1,}]/g,'');" /></td>
												<td th:id = "innerNums+(${p.goodsId})"><input type="text"  onkeyup="value=value.replace(/[^\d]/g,'')" /></td>
												<td th:id = "innerGoodsNums+(${p.goodsId})"><input type="text"  onkeyup="value=value.replace(/[^\d]/g,'')" /></td>
												<td th:id = "validate+(${p.goodsId})"><input type="text"  value=""  class="datepicker" placeholder="请选择有效期"/></td>
												<td>
													<button class="btn btn-info btn-xs dropdown-toggle"
														type="button" th:onclick="singleEntry([[${p.goodsId}]])">
														<i class="fa fa-edit"></i>纳品
													</button>
												</td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
							<div class="row">
								<div class="col-sm-12">
									<div class="form-group">
										<button type="button" class="btn btn-primary" th:onclick="batchEntry()">纳品</button>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				</div>
			</div>
			<div class="footer" th:include="/c/footer :: copyright"></div>
		</div>
	</div>


	<!-- Mainly scripts -->
	<script th:src="@{/js/jquery-3.1.1.min.js}"></script>

	<script th:src="@{/js/bootstrap.min.js}"></script>
	<script th:src="@{/js/plugins/sweetalert/sweetalert.min.js}"></script>
	<script th:src="@{/js/plugins/metisMenu/jquery.metisMenu.js}"></script>
	<script th:src="@{/js/plugins/slimscroll/jquery.slimscroll.min.js}"></script>

	<!-- Data Tables -->
	<script th:src="@{/js/plugins/dataTables/datatables.min.js}"></script>

	<script th:src="@{/js/plugins/iCheck/icheck.min.js}"></script>
	<script th:src="@{/js/plugins/jasny/jasny-bootstrap.min.js}"></script>

	<!-- Peity -->
	<script th:src="@{/js/plugins/peity/jquery.peity.min.js}"></script>

	<!-- Custom and plugin javascript -->
	<script th:src="@{/js/inspinia.js}"></script>
	<script th:src="@{/js/plugins/pace/pace.min.js}"></script>

	<!-- iCheck -->
	<script th:src="@{/js/plugins/iCheck/icheck.min.js}"></script>

	<!-- Peity -->
	<script th:src="@{/js/demo/peity-demo.js}"></script>

	<!-- Data picker -->
	<script th:src="@{/js/plugins/datapicker/bootstrap-datepicker.js}"></script>
	<!-- FooTable -->
	<script th:src="@{/js/plugins/footable/footable.all.min.js}"></script>

	<!-- select data -->
	<script th:src="@{/js/bootstrap-select.js}"></script>

	<!-- common -->
	<script th:src="@{/js/common.js}"></script>

	<script th:src="@{/js/entry/apply.js}"></script>
	<script th:inline="javascript">
		$(document).ready(function() {
			$('.i-checks').iCheck({
				checkboxClass : 'icheckbox_square-green',
				radioClass : 'iradio_square-green',
			});
			
			$('#doUpload').click(function(){
				$('#form').submit();
			});
		});
	</script>

	<script th:inline="javascript">
        $(document).ready(function() {
            $('.footable').footable();
            $('.i-checks').iCheck({
                checkboxClass : 'icheckbox_square-green',
                radioClass : 'iradio_square-green',
            });
            $('.datepicker').datepicker({
                format : 'yyyy-mm-dd',
                language : 'zh-CN',
                todayBtn : "linked",//显示‘今日’按钮
                clearBtn : true,//清除按钮
                keyboardNavigation : false,
                forceParse : false,
                autoclose : true
            });
        });
	</script>

</body>

</html>
